# ğŸ¯ Price Comparator - Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº Ğ¸ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

## ĞĞ±Ğ·Ğ¾Ñ€

**Price Comparator** - ÑÑ‚Ğ¾ AI-powered Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ¸ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ†ĞµĞ½ Ğ½Ğ° ÑƒÑĞ»ÑƒĞ³Ğ¸ Ñ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞº Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹ Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° HTML, Ğ¸Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑƒÑĞ»ÑƒĞ³.

---

## ğŸ— ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Next.js App Router + React 19                        â”‚  â”‚
â”‚  â”‚  - Input Ñ„Ğ¾Ñ€Ğ¼Ğ° (URL Ğ²Ğ°ÑˆĞ¸Ñ… ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ† + ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ²)     â”‚  â”‚
â”‚  â”‚  - Real-time Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ Ñ‡ĞµÑ€ĞµĞ· SSE                      â”‚  â”‚
â”‚  â”‚  - Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸ĞµĞ¼ Ñ†ĞµĞ½             â”‚  â”‚
â”‚  â”‚  - Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² CSV                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    HTTP POST /api/price-comparator
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API BACKEND                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Next.js API Route (route.ts)                        â”‚  â”‚
â”‚  â”‚  - Server-Sent Events (SSE) streaming                â”‚  â”‚
â”‚  â”‚  - Orchestration pipeline                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Step 1       â”‚  â”‚ Step 2       â”‚  â”‚ Step 3          â”‚  â”‚
â”‚  â”‚ Fetch HTML   â”‚â†’ â”‚ Clean HTML   â”‚â†’ â”‚ AI Extraction   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â†“                 â†“                    â†“            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Cheerio                          â”‚   â”‚
â”‚  â”‚  - Remove scripts, styles, images                  â”‚   â”‚
â”‚  â”‚  - Extract text content                            â”‚   â”‚
â”‚  â”‚  - Clean whitespace                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    OpenAI API (GPT-4o)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AI PROCESSING                          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Phase 1: Price Extraction (Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞ°Ğ¹Ñ‚Ğ°)       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚:                                         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ’Ğ¡Ğ• Ñ†ĞµĞ½Ñ‹ Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğµ                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ÑŒ Ğ¸Ğ· Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†, ÑĞ¿Ğ¸ÑĞºĞ¾Ğ², JSON-LD, Ñ‚ĞµĞºÑÑ‚Ğ°  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ ÑƒÑĞ»ÑƒĞ³              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ñ‹ Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹             â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â†“                                                    â”‚  â”‚
â”‚  â”‚  Output: [{ service, price }, ...]                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Phase 2: Service Matching                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚:                                         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - Ğ¡Ğ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğµ ÑƒÑĞ»ÑƒĞ³Ğ¸         â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - Ğ£Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ (Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´ÑŒ, Ğ²Ñ€ĞµĞ¼Ñ Ğ¸ Ñ‚.Ğ´.)  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - Ğ‘Ñ‹Ñ‚ÑŒ ĞºĞ¾Ğ½ÑĞµÑ€Ğ²Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼ (Ğ»ÑƒÑ‡ÑˆĞµ Ğ¿ÑƒÑÑ‚Ğ¾)            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ - 2-ĞºĞ¾Ğ¼Ğ½ â‰  3-ĞºĞ¾Ğ¼Ğ½ (Ğ½Ğµ ÑĞ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑÑ‚ÑŒ!)           â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â†“                                                    â”‚  â”‚
â”‚  â”‚  Output: Comparison table                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                       SSE Stream Results
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                            â”‚
â”‚  - Update Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸                      â”‚
â”‚  - ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ                        â”‚
â”‚  - Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² CSV                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

### Frontend Layer

#### **Next.js 16**
- **App Router** - ĞĞ¾Ğ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- **React Server Components** - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- **Client Components** - Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ UI

#### **React 19**
- **Hooks** - useState, useEffect Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸ĞµĞ¼
- **Streaming** - ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° SSE Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°
- **TypeScript** - ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

#### **Tailwind CSS 4**
- **Utility-first** - Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑÑ‚Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- **Responsive design** - ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
- **Custom Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹** - Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ UI

#### **Lucide React**
- **Icons** - Loader2, Plus, X, BarChart3, AlertCircle
- **SVG-based** - ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
- **Ğ›ĞµĞ³ĞºĞ¾Ğ²ĞµÑĞ½Ğ¾ÑÑ‚ÑŒ** - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ bundle size

---

### Backend Layer

#### **Next.js API Routes**
- **Edge-compatible** - Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹
- **Serverless-ready** - Ğ›ĞµĞ³ĞºĞ¾Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹Ğ¼ĞµĞ½Ñ‚
- **TypeScript-first** - Ğ¢Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ· ĞºĞ¾Ñ€Ğ¾Ğ±ĞºĞ¸

#### **Server-Sent Events (SSE)**
```typescript
Content-Type: text/event-stream
Connection: keep-alive

data: {"type": "progress", "message": "Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ HTML..."}
data: {"type": "result", "data": {...}}
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ° SSE:**
- âœ… ĞĞ´Ğ½Ğ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº (ÑĞµÑ€Ğ²ĞµÑ€ â†’ ĞºĞ»Ğ¸ĞµĞ½Ñ‚)
- âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ reconnect
- âœ… ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ğ° Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ vs WebSocket
- âœ… Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ñ HTTP/2

#### **Cheerio**
```typescript
const $ = cheerio.load(html);
$('script, style, noscript, iframe, img, svg').remove();
const text = $('body').text();
```

**Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:**
- jQuery-like API
- Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ HTML
- DOM manipulation
- Ğ¡ĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ñ‹ CSS

**ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ñ‹:**
- JSDOM (Ñ‚ÑĞ¶ĞµĞ»ĞµĞµ, Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ DOM)
- Puppeteer (Ğ´Ğ»Ñ JavaScript-rendered)
- Playwright (Ğ´Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… ÑĞ°Ğ¹Ñ‚Ğ¾Ğ²)

---

### AI Layer

#### **OpenAI GPT-4o**

**ĞœĞ¾Ğ´ĞµĞ»ÑŒ:** `gpt-4o`  
**Release:** May 2024  
**Context:** 128K tokens  
**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ñ€ÑƒÑÑĞºĞ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ°
- JSON mode Ğ´Ğ»Ñ structured outputs
- Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Ğ Ğ°Ğ·ÑƒĞ¼Ğ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ ($2.50/$10.00 per 1M tokens)

**ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ:**
```typescript
{
  model: 'gpt-4o',
  temperature: 0.1,           // ĞĞ¸Ğ·ĞºĞ°Ñ Ğ´Ğ»Ñ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸
  response_format: { 
    type: 'json_object'       // Structured outputs
  }
}
```

**ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸:**

| ĞœĞ¾Ğ´ĞµĞ»ÑŒ | Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ | Ğ¢Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ | Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ | Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ |
|--------|-----------|----------|----------|--------------|
| GPT-4o | $$ | â­â­â­â­â­ | â­â­â­â­ | âœ… ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ |
| GPT-4 Turbo | $$$ | â­â­â­â­â­ | â­â­â­ | Ğ”Ğ»Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ñ… ĞºĞµĞ¹ÑĞ¾Ğ² |
| GPT-3.5 Turbo | $ | â­â­â­ | â­â­â­â­â­ | Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ° |
| Claude 3 Opus | $$$ | â­â­â­â­â­ | â­â­â­ | ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° GPT-4 |
| Claude 3 Sonnet | $$ | â­â­â­â­ | â­â­â­â­ | Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ñ†ĞµĞ½Ğ°/ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ |
| Gemini Pro | $ | â­â­â­â­ | â­â­â­â­ | Google ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° |

---

## ğŸ”„ Data Flow Pipeline

### Phase 1: Input Collection

```typescript
interface RequestBody {
  ourServiceUrl: string;      // "https://mysite.com/services"
  ourPriceUrl: string;        // "https://mysite.com/prices"
  competitors: Array<{
    id: string;               // "1"
    url: string;              // "https://competitor.com/prices"
    name?: string;            // "Competitor A"
  }>;
  apiKey: string;             // "sk-..."
}
```

---

### Phase 2: HTML Fetching

```typescript
async function fetchHTML(url: string): Promise<string> {
  const response = await fetch(url, {
    headers: {
      'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
    }
  });
  return await response.text();
}
```

**ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°:**
```typescript
const [ourServiceHTML, ourPriceHTML] = await Promise.all([
  fetchHTML(ourServiceUrl),
  fetchHTML(ourPriceUrl)
]);
```

**ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:**
- Network timeouts
- 404/500 errors
- Blocked requests (403)
- CORS issues (for client-side)

---

### Phase 3: HTML Cleaning

```typescript
function cleanHTML(html: string): string {
  const $ = cheerio.load(html);
  
  // Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ½ÑƒĞ¶Ğ½Ñ‹Ñ… ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
  $('script, style, noscript, iframe, img, svg').remove();
  
  // Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑÑ‚Ğ°
  const text = $('body').text();
  
  // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° whitespace
  return text.replace(/\s+/g, ' ').trim();
}
```

**Ğ§Ñ‚Ğ¾ ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ÑÑ:**
- `<script>` - JavaScript ĞºĞ¾Ğ´
- `<style>` - CSS ÑÑ‚Ğ¸Ğ»Ğ¸
- `<noscript>` - Fallback ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
- `<iframe>` - Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ñ€ĞµĞ¹Ğ¼Ñ‹
- `<img>`, `<svg>` - Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ

**Ğ§Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°ĞµÑ‚ÑÑ:**
- Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
- Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° HTML (Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ°)
- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ (Ğ²Ğ°Ğ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ñ†ĞµĞ½!)
- Ğ¡Ğ¿Ğ¸ÑĞºĞ¸ (Ñ‡Ğ°ÑÑ‚Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Ğ¿Ñ€Ğ°Ğ¹ÑÑ‹)

---

### Phase 4: AI Price Extraction

**Input:**
```
Ğ¢ĞµĞºÑÑ‚ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹: "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹ ... Ñ†ĞµĞ½Ğ° 4000 Ñ€ÑƒĞ±Ğ»ĞµĞ¹"
```

**ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚:**
```
ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ Ñ‚ĞµĞºÑÑ‚ Ğ¸ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ¸ Ğ’Ğ¡Ğ• Ñ†ĞµĞ½Ñ‹.
ĞĞ°Ğ¹Ğ´Ğ¸ Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°Ñ…, ÑĞ¿Ğ¸ÑĞºĞ°Ñ…, JSON-LD, Ñ‚ĞµĞºÑÑ‚Ğµ.
Ğ’ĞµÑ€Ğ½Ğ¸ JSON: [{ service, price }, ...]
```

**Output:**
```json
[
  {
    "service": "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹",
    "price": "4000 Ñ€ÑƒĞ±Ğ»ĞµĞ¹"
  }
]
```

**Ğ¢Ğ¸Ğ¿Ñ‹ Ñ†ĞµĞ½, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ AI Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°ĞµÑ‚:**
- `3500 Ñ€ÑƒĞ±.`
- `Ğ¾Ñ‚ 3000 Ğ´Ğ¾ 5000 Ñ€ÑƒĞ±Ğ»ĞµĞ¹`
- `$50 per hour`
- `3 500 â‚½`
- `Price: 3,500 RUB`
- `Ñ‚Ñ€Ğ¸ Ñ‚Ñ‹ÑÑÑ‡Ğ¸ Ñ€ÑƒĞ±Ğ»ĞµĞ¹` (Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ¼)

---

### Phase 5: Service Matching

**Input:**
```json
{
  "ourServices": [
    { "service": "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹", "price": "4000 Ñ€ÑƒĞ±." }
  ],
  "competitors": {
    "Comp1": [
      { "service": "ĞšĞ»Ğ¸Ğ½Ğ¸Ğ½Ğ³ Ğ´Ğ²ÑƒÑ…ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ĞºĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ñ‹", "price": "3500 Ñ€ÑƒĞ±." }
    ],
    "Comp2": [
      { "service": "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 3-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹", "price": "5500 Ñ€ÑƒĞ±." }
    ]
  }
}
```

**AI Matching Logic:**

```
âœ… Ğ¡ĞĞŸĞĞ¡Ğ¢ĞĞ’Ğ˜Ğ¢Ğ¬:
- "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½" â†” "ĞšĞ»Ğ¸Ğ½Ğ¸Ğ½Ğ³ Ğ´Ğ²ÑƒÑ…ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹"
  (Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°, Ğ¾Ğ´Ğ½Ğ° ÑƒÑĞ»ÑƒĞ³Ğ°)

âŒ ĞĞ• Ğ¡ĞĞŸĞĞ¡Ğ¢ĞĞ’Ğ›Ğ¯Ğ¢Ğ¬:
- "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½" â›” "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 3-ĞºĞ¾Ğ¼Ğ½"
  (Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹)
```

**Output:**
```json
{
  "comparison": [
    {
      "service": "Ğ£Ğ±Ğ¾Ñ€ĞºĞ° 2-ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğ½Ğ¾Ğ¹",
      "ourPrice": "4000 Ñ€ÑƒĞ±.",
      "competitorPrices": {
        "Comp1": "3500 Ñ€ÑƒĞ±.",
        "Comp2": ""
      }
    }
  ]
}
```

---

## ğŸ¨ UI/UX Design

### Component Structure

```
<PriceComparator>
  â”œâ”€â”€ <Header> - Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº Ğ¸ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
  â”œâ”€â”€ <ApiKeySection> - Ğ’Ğ²Ğ¾Ğ´ OpenAI ĞºĞ»ÑÑ‡Ğ°
  â”œâ”€â”€ <OurSiteSection>
  â”‚   â”œâ”€â”€ <Input> - URL ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ñ ÑƒÑĞ»ÑƒĞ³Ğ°Ğ¼Ğ¸
  â”‚   â””â”€â”€ <Input> - URL ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ñ Ñ†ĞµĞ½Ğ°Ğ¼Ğ¸
  â”œâ”€â”€ <CompetitorsSection>
  â”‚   â””â”€â”€ <CompetitorInput>[] - Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº
  â”œâ”€â”€ <AnalyzeButton> - Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
  â”œâ”€â”€ <ProgressSection> - Real-time ÑÑ‚Ğ°Ñ‚ÑƒÑ
  â”œâ”€â”€ <ErrorSection> - ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
  â””â”€â”€ <ResultsSection>
      â”œâ”€â”€ <ComparisonTable> - Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼Ğ¸
      â””â”€â”€ <ExportButton> - CSV ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚
```

### Design Principles

1. **Progressive Disclosure**
   - Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ
   - Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ñ‹ Ğ¿Ğ¾ ĞºĞ»Ğ¸ĞºÑƒ

2. **Real-time Feedback**
   - SSE Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ
   - Loader Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹
   - Error messages inline

3. **Responsive Design**
   - Mobile-first approach
   - Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑĞ¾ scrollbar Ğ½Ğ° Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…
   - Touch-friendly buttons

4. **Accessibility**
   - Semantic HTML
   - ARIA labels
   - Keyboard navigation

---

## ğŸ“Š Data Models

### TypeScript Interfaces

```typescript
interface CompetitorUrl {
  id: string;
  url: string;
  name?: string;
}

interface ServicePrice {
  service: string;
  price: string;
}

interface ComparisonRow {
  service: string;
  ourPrice: string;
  competitorPrices: Record<string, string>;
}

interface AnalysisResult {
  ourServices: ServicePrice[];
  competitors: Record<string, ServicePrice[]>;
  comparison: ComparisonRow[];
}

interface SSEMessage {
  type: 'progress' | 'result' | 'error';
  message?: string;
  data?: AnalysisResult;
}
```

---

## ğŸ”’ Security

### API Key Handling

```typescript
// âœ… Ğ¥ĞĞ ĞĞ¨Ğ: ĞšĞ»ÑÑ‡ Ğ² Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ, Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ
const apiKey = request.body.apiKey;
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ñ€Ğ°Ğ¼ĞºĞ°Ñ… Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°

// âŒ ĞŸĞ›ĞĞ¥Ğ: ĞšĞ»ÑÑ‡ Ğ² .env (ĞµÑĞ»Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿)
const apiKey = process.env.OPENAI_API_KEY;
```

### Input Validation

```typescript
// Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ URL
if (!ourServiceUrl || !ourPriceUrl) {
  return { error: 'Missing URLs' };
}

// Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ API ĞºĞ»ÑÑ‡Ğ°
if (!apiKey || !apiKey.startsWith('sk-')) {
  return { error: 'Invalid API key' };
}

// Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Ğ½Ğ° ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ²
if (competitors.length > 20) {
  return { error: 'Too many competitors (max 20)' };
}
```

### Rate Limiting

```typescript
// ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾: Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ rate limiting
import rateLimit from '@/lib/rate-limit';

const limiter = rateLimit({
  interval: 60 * 1000, // 1 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ°
  uniqueTokenPerInterval: 500,
});

await limiter.check(10, 'CACHE_TOKEN'); // 10 req/min
```

---

## ğŸ“ˆ Performance Optimization

### 1. ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

```typescript
// âŒ ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ (Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾)
for (const url of urls) {
  const html = await fetchHTML(url);
}

// âœ… ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ (Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾)
const htmls = await Promise.all(
  urls.map(url => fetchHTML(url))
);
```

### 2. ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```typescript
import NodeCache from 'node-cache';

const cache = new NodeCache({ stdTTL: 3600 });

function fetchHTMLCached(url: string) {
  const cached = cache.get(url);
  if (cached) return cached;
  
  const html = await fetchHTML(url);
  cache.set(url, html);
  return html;
}
```

### 3. Streaming Results

```typescript
// ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ¿Ğ¾ Ğ¼ĞµÑ€Ğµ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
for (const competitor of competitors) {
  const prices = await extractPrices(competitor);
  
  sendProgress({
    type: 'partial_result',
    data: prices
  });
}
```

### 4. HTML Truncation

```typescript
// ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ´Ğ»Ñ ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ğ¸ tokens
const maxChars = 30000;
const truncated = text.length > maxChars 
  ? text.substring(0, maxChars) + '...'
  : text;
```

---

## ğŸ§ª Testing Strategy

### Unit Tests

```typescript
// HTML cleaning
test('cleanHTML removes scripts', () => {
  const html = '<html><script>alert("XSS")</script><body>Content</body></html>';
  const clean = cleanHTML(html);
  expect(clean).not.toContain('script');
  expect(clean).toContain('Content');
});

// Price parsing
test('parsePrice extracts number', () => {
  expect(parsePrice('3500 Ñ€ÑƒĞ±.')).toBe(3500);
  expect(parsePrice('Ğ¾Ñ‚ 3000 Ğ´Ğ¾ 5000')).toBe(3000);
});
```

### Integration Tests

```typescript
// Full pipeline
test('analyzes prices end-to-end', async () => {
  const result = await analyzePrices({
    ourServiceUrl: 'https://example.com/services',
    ourPriceUrl: 'https://example.com/prices',
    competitors: [{ url: 'https://comp.com/prices' }],
    apiKey: 'test-key'
  });
  
  expect(result.comparison).toBeDefined();
  expect(result.comparison.length).toBeGreaterThan(0);
});
```

### E2E Tests (Playwright)

```typescript
test('user can analyze prices', async ({ page }) => {
  await page.goto('http://localhost:3000/price-comparator');
  
  // Fill form
  await page.fill('input[placeholder*="API"]', 'sk-test-key');
  await page.fill('input[placeholder*="services"]', 'https://example.com');
  
  // Submit
  await page.click('button:has-text("ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·")');
  
  // Wait for results
  await page.waitForSelector('table', { timeout: 60000 });
  
  // Check results
  const rows = await page.$$('table tbody tr');
  expect(rows.length).toBeGreaterThan(0);
});
```

---

## ğŸš€ Deployment

### Vercel (Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)

```bash
# Install Vercel CLI
npm i -g vercel

# Deploy
vercel
```

**ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ** (`vercel.json`):
```json
{
  "functions": {
    "app/api/price-comparator/route.ts": {
      "maxDuration": 300
    }
  }
}
```

### Docker

```dockerfile
FROM node:20-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --production

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

### Environment Variables

```bash
# Production
OPENAI_API_KEY=sk-prod-key
NEXT_PUBLIC_APP_URL=https://yourdomain.com
NODE_ENV=production
```

---

## ğŸ“Š Monitoring & Analytics

### Logging

```typescript
import { logger } from '@/lib/logger';

logger.info('Price analysis started', {
  competitorCount: competitors.length,
  timestamp: new Date()
});

logger.error('Failed to fetch HTML', {
  url,
  error: error.message
});
```

### Metrics

```typescript
// Track performance
const startTime = Date.now();

// ... processing ...

const duration = Date.now() - startTime;
await recordMetric('price_analysis_duration', duration);
await recordMetric('services_found', result.comparison.length);
```

### Error Tracking (Sentry)

```typescript
import * as Sentry from '@sentry/nextjs';

try {
  // ... processing ...
} catch (error) {
  Sentry.captureException(error, {
    tags: {
      feature: 'price-comparator',
      url: ourServiceUrl
    }
  });
}
```

---

## ğŸ’° Cost Analysis

### OpenAI API Costs (GPT-4o)

**ĞŸÑ€Ğ°Ğ¹ÑĞ¸Ğ½Ğ³:**
- Input: $2.50 / 1M tokens
- Output: $10.00 / 1M tokens

**Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:**
- Input: ~10,000 tokens (HTML Ñ‚ĞµĞºÑÑ‚ + Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹)
- Output: ~1,000 tokens (JSON Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹)
- **Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:** ~$0.015 per website

**ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (6 ÑĞ°Ğ¹Ñ‚Ğ¾Ğ²):**
- Ğ’Ğ°Ñˆ ÑĞ°Ğ¹Ñ‚: 2 ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ = $0.03
- 5 ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ²: 5 Ã— $0.015 = $0.075
- Ğ¡Ğ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: $0.015
- **Ğ˜Ñ‚Ğ¾Ğ³Ğ¾:** ~$0.12 per analysis

**ĞœĞµÑÑÑ‡Ğ½Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:**
- Ğ•Ğ¶ĞµĞ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·: $0.12 Ã— 30 = $3.60/month
- Ğ•Ğ¶ĞµĞ½ĞµĞ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹: $0.12 Ã— 4 = $0.48/month

---

## ğŸ”® Future Enhancements

### ĞšÑ€Ğ°Ñ‚ĞºĞ¾ÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ (1-2 Ğ¼ĞµÑÑÑ†Ğ°)

1. **Puppeteer integration**
   - ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° JavaScript-rendered ÑĞ°Ğ¹Ñ‚Ğ¾Ğ²
   - Screenshot Ğ´Ğ»Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°

2. **Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²**
   - Database (PostgreSQL/MongoDB)
   - ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¿Ñ€Ğ¾ÑˆĞ»Ñ‹Ñ… Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
   - Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ Ñ†ĞµĞ½

3. **Batch Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°**
   - ĞĞ½Ğ°Ğ»Ğ¸Ğ· 20+ ĞºĞ¾Ğ½ĞºÑƒÑ€ĞµĞ½Ñ‚Ğ¾Ğ² Ğ·Ğ° Ñ€Ğ°Ğ·
   - Queue ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°

4. **Excel export**
   - Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
   - Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ² Excel
   - Conditional formatting

### Ğ¡Ñ€ĞµĞ´Ğ½ĞµÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ (3-6 Ğ¼ĞµÑÑÑ†ĞµĞ²)

5. **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³**
   - Cron jobs
   - Email ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
   - Webhook Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

6. **Multi-LLM support**
   - Claude 3
   - Gemini Pro
   - Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ² UI

7. **Advanced matching**
   - Fuzzy matching Ğ´Ğ»Ñ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğ¹
   - ML-based ÑĞ¾Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
   - Confidence scores

8. **API endpoints**
   - REST API
   - Authentication
   - Rate limiting

### Ğ”Ğ¾Ğ»Ğ³Ğ¾ÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ (6+ Ğ¼ĞµÑÑÑ†ĞµĞ²)

9. **Collaborative features**
   - Multi-user accounts
   - Team workspaces
   - Comments and notes

10. **Analytics dashboard**
    - Price trends over time
    - Market positioning
    - Competitor insights

11. **Mobile app**
    - React Native
    - Push notifications
    - Offline mode

12. **AI recommendations**
    - Pricing suggestions
    - Market analysis
    - Competitive strategy

---

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹

### Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
- [Next.js Docs](https://nextjs.org/docs)
- [OpenAI API Reference](https://platform.openai.com/docs/api-reference)
- [Cheerio Documentation](https://cheerio.js.org/)
- [Server-Sent Events Spec](https://html.spec.whatwg.org/multipage/server-sent-events.html)

### Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹
- [Puppeteer](https://pptr.dev/) - Headless Chrome
- [Playwright](https://playwright.dev/) - Browser automation
- [LangChain](https://js.langchain.com/) - LLM framework
- [Vercel AI SDK](https://sdk.vercel.ai/) - AI utilities

---

**Ğ’ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°:** 1.0.0  
**ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:** Ğ”ĞµĞºĞ°Ğ±Ñ€ÑŒ 2025  
**ĞĞ²Ñ‚Ğ¾Ñ€:** Ğ˜Ğ³Ğ¾Ñ€ÑŒ Ğ‘ÑƒÑ€Ğ´ÑƒĞºĞ¾Ğ²



